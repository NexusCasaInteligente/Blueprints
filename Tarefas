blueprint:
  name: Espanar a Casa - Versão Parametrizável
  description: Liga o input_boolean após um número configurável de dias, com reset manual ao desligar. Inclui horário de execução configurável.
  domain: automation
  input:
    boolean_alvo:
      name: Input Boolean
      description: O input_boolean que será ligado após X dias
      selector:
        entity:
          domain: input_boolean

    contador:
      name: Contador
      description: Contador que será incrementado diariamente e resetado ao desligar o boolean
      selector:
        entity:
          domain: counter

    dias_para_ativar:
      name: Dias para Ativar
      description: Quantidade de dias para acionar o input_boolean
      default: 7
      selector:
        number:
          min: 1
          max: 30
          unit_of_measurement: dias
          mode: slider

    horario_execucao:
      name: Horário de Execução Diária
      description: Horário em que o contador será incrementado (formato HH:MM:SS)
      default: "00:01:00"
      selector:
        time: {}

trigger:
  - platform: time
    at: !input horario_execucao
    id: incrementar
  - platform: state
    entity_id: !input boolean_alvo
    from: "on"
    to: "off"
    id: resetar

action:
  - choose:
      - conditions:
          - condition: trigger
            id: incrementar
        sequence:
          - service: counter.increment
            target:
              entity_id: !input contador
          - delay: "00:00:01"

  - choose:
      - conditions:
          - condition: trigger
            id: resetar
        sequence:
          - service: counter.reset
            target:
              entity_id: !input contador

  - choose:
      - conditions:
          - condition: or
            conditions:
              - condition: trigger
                id: incrementar
              - condition: trigger
                id: resetar
