blueprint:
  name: "Ativar Tarefas Baseadas em Dias"
  description: "Liga booleanos quando contadores atingem dias configurados"
  domain: automation
  input:
    tarefas:
      name: "Lista de Tarefas"
      description: "Adicione cada tarefa com contador, booleano e dias mÃ­nimos"
      selector:
        object:
          schema:
            contador:
              name: "Contador"
              selector:
                entity:
                  domain: counter
            booleano:
              name: "Booleano"
              selector:
                entity:
                  domain: input_boolean
            dias_minimos:
              name: "Dias para Ativar"
              selector:
                number:
                  min: 1
                  max: 365
                  step: 1
      default: []

trigger:
  - platform: state
    entity_id: !input "tarefas.contador"

action:
  - choose:
      - conditions:
          - condition: template
            value_template: >
              {% set config = tarefas|selectattr('contador', 'equalto', trigger.entity_id)|list|first %}
              {{ states(trigger.entity_id)|int >= (config.dias_minimos|int) }}
        sequence:
          - service: input_boolean.turn_on
            target:
              entity_id: "{{ config.booleano }}"
mode: queued
